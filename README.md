# wikibot

A bot framework for editing MediaWiki wikis, primarily [shinto.miraheze.org](https://shinto.miraheze.org), with integration against Wikidata and the [pramana.dev](https://pramana.dev) server.

---

## Current state

The root directory and `shinto_miraheze/` contain hundreds of accumulated one-off scripts, log files, and data CSVs from several years of iterative work. Most of these are legacy ChatGPT-era scripts that are no longer needed. A cleanup pass is planned (see [VISION.md](VISION.md)).

The active, maintained scripts are documented in [SCRIPTS.md](SCRIPTS.md).

---

## Active scripts (shinto.miraheze.org pipeline)

| Script | Purpose |
|--------|---------|
| `shinto_miraheze/resolve_category_wikidata_from_interwiki.py` | Resolves Wikidata QIDs for category pages by querying their interwiki links |
| `create_category_qid_redirects.py` | Creates `Q{QID}` redirect pages in mainspace pointing to their category |
| `fix_ill_destinations.py` | Fixes broken ILL template destinations |
| `add_moved_templates.py` | Adds `{{moved to}}` / `{{moved from}}` templates after page moves |
| `remove_defaultsort_digits.py` | Removes `{{DEFAULTSORT:}}` from Wikidata-generated shikinaisha pages |
| `fix_dup_cat_links.py` | One-off: fixes `[[Category:X]]` → `[[:Category:X]]` in dup disambiguation pages |

---

## Credentials / secrets

**All scripts currently have hardcoded credentials.** This must be fixed before the repo can be made public. See [VISION.md § Secrets](VISION.md#secrets) for the plan.

Until then, do not share this repo publicly.

Required credentials (to be moved to environment variables or a `.env` file):
- `USERNAME` / `PASSWORD` — MediaWiki bot account (`Immanuelle` on shinto.miraheze.org)
- Pramana server credentials (future)

---

## Setup

```bash
pip install mwclient requests
```

Run any script directly:
```bash
python create_category_qid_redirects.py
python shinto_miraheze/resolve_category_wikidata_from_interwiki.py
```

---

## See also

- [VISION.md](VISION.md) — full architecture plan and future direction
- [SCRIPTS.md](SCRIPTS.md) — catalog of all scripts with status
- [API.md](API.md) — how every external service is accessed (mwclient, Wikidata, Wikipedia APIs)
- [SHINTOWIKI_STRUCTURE.md](SHINTOWIKI_STRUCTURE.md) — page structure on shintowiki: `{{ill}}`, `{{wikidata link}}`, QID redirects, category/template/talk page conventions, known issues

  URGENT

  OK so I had a bit of a fuck up where I sent a very very large prompt to Claude code about what I was doing and then as it was doing other work and I probably should've saved it in like no pad or something but basically basically my computer ended up crashing the wall it was executing so I'm just trying to say basically what it is here so what I am trying to get is basically like I want us to actually be tracking the two due stuff in the I want us to be tracking the to-do stuff for the wiki in this repository now because right now because earlier it was mostly just either half hazard pages on the wiki which which made it to the Claude wasn't really able to help that much with figuring out what the direction was and also I'm just kind of me remembering stuff and like me remembering stuff is good and all but it's I'm not the most reliable so yeah but I'm in a rush right now and that's why it is that I'm editing this based I'm I'm editing this through my phone with speech to text kind of panicking of it but yeah to see what is happening right now but basically OK so essentially on the wiki that there was a whole debacle where the wiki ended up getting suspended and reinstated but like the history isn't properly being imported you can look at the main space of the the main page of the wiki and stuff to kind of get a general idea but the basic issue is that the wiki was restored with XML wiki was restored with XML from archived.org the XML that was made with the wiki the XML that was made the XML that the wiki was restored from was technically the entire history of the wiki but it was like weirdly partially archived and then I took only the most recent version of it to reimport in reimport in January and so and so they're still pending on the actual import of the full history but I'm gonna try to explain what was going on so basically I mean I'm gonna try to explain it so so basically as as you can see on the main page of the wiki basically the main page of the as you can see on the main page of the wiki basically but we need to properly preserve the history and so I introduced templates to do like moving the histories to do like history merges so that the pages maintain their histories and I think that that is pretty self-explanatory there's there's weirdness of there's weirdness of it of course there's a lot of edge cases and I did categorization document I did categorization to document the edge cases of all the stuff I did categorization to document the edge cases of all the stuff so you don't really really need to do a fuck ton of stuff with the categorizations you just need to kind of basically understand it but do keep in mind that like essentially there were two different different waves of movement because of like some weird unicorn code Uno code shit there are some weird un basically and this means that there's like a couple of different reason reasons why it is that a page might've been might be above a move target and a move and move destination there might be there might be two different ones but yeah that's just a thing to kind of vaguely established but yeah I know we're just doing it because we want the histories to be properly coherent but I wanna explain roughly the timeline of the wiki so I was I started using Wikipedia in in 2020 in 2023 I started to get serious problems with Wikipedia basically my my pages were often that I've moved into but moved from main space to draft Space or other above I was doing a lot of translation I had like a translation workflow set up but the problem is basically as you can kind of see in the vision.TXT you think they didn't like that they didn't like that I was doing that because because they didn't like I'm not I'm not gonna get I'm not going to go into the full details of all like my trauma from Wikipedia I ended up with a very very large amount of amount of pages in draft space because I had editing restrictions put on me making it so that I couldn't put published a main space so I ended up getting a peak around 4000 drafts I was blocked from editing I ended up getting blocked permitting around 2023 and was unable to keep the drafts from being deleted so what I ended up doing was I ended up basically I had some drafts that I was editing on simple English Wikipedia for a while but I decided to make this wiki and I imported my simple English Wikipedia draft my English Wikipedia draft if they existed and some of them came from everybody wiki I believe I had about maybe a couple hundred pages or so to start from that I started doing other stuff like I did history import pretty much all of the pretty much all of the Japanese origin pages have history history imports of their Japanese editing history which is part of the reason why it is that the wicked size is so massive

  eventually I started using eventually I came to the I came to the practice of starting to basically use the inter language link template to go to any article that I did not but that did not exist in English Wikipedia briefly I had all the things that linked to English Wikipedia go directly to English Wikipedia but that kind of cause problems and like and one other and the other user ended up not liking that not liking that so I ended up eventually going towards the current practice is every single link in the entire wiki is an inter language link every single link on Wikipedia is the English every single link is the inter language link and earlier I used to use it primarily based around the earlier I used to use a primarily based around the Japanese Wikipedia based around the Japanese Wikipedia link there that I had a couple random drafts that were about other things like a couple of Russian orthodox icons and deities and had a couple a couple Russian Orthodox icons in Td and a couple a couple Russian Orthodox icons and deities and some like ancient Egyptian stuff so like there's there's a bit of like stuff that's not Japanese of origin and but yeah like in order in order to do proper proper citation of the histories there's a translated page template on almost every single page sometimes because of the auto because of the way that I was using ChatGPT to translate pages early on and add in their inter language links most of them go well a couple of them go to like go to the wrong pages a couple of them go to the wrong pages a couple of them go to the wrong pages mostly it's around like disambiguation pages where like something has like this there's also a couple duplicated pages and you can see them in the category she can show emerges although that is a horrible category so I am just going to rename it right now I'm going to rename the category right now and if you check if you check right now but you will see on the wiki is that I have immediately renamed it to something something that's more descriptive and better I don't know what it is yet I'm actively doing it while I'm recording this I'm actively doing this while recording It but I am actively doing it while I'm recording it but my guess is it's probably gonna be something yeah yeah pages with duplicated content yeah I've factored it all to be pages with duplicate content using special replace text

another thing to establish here is that with our inter language links are inter language links rather frequently use link titles and a very frequently have they use positional parameters by default ours very frequently have accumulated very large amounts of like a combination of positional parameters and like a manual overrides a positional parameters this sometimes has useful information it usually does not but just keep in mind all this stuff like the intro language template is a horrible beast of a template it's not really the ideal thing to do but it's something that we used anyway anyways 

Yeah and also kind of continuing on this path kind of continuing down this path of kind of continuing on this path of like the continued usage of the intro language link template eventually eventually we came to the decision that we were sorry no no no I actually I just wanted to jump forward technically this were repository was created created if I were correctly for like doing wiki data edits or something actually I think it was for Chanel wiki but they did a lot of a lot of media with wicked data edits I started doing a very large my initial project on the wiki was to try to get the Bappi shrines or the special shrines according to the association of shrines I was trying to get them all updated and so we had a translation of all of them eventually I ended up moving towards the shrines I did a massive mass yeah but for cheeky shrines cheeky shrines what I noticed was that Japanese Wikipedia had very very large well documented pages of the English these were not on wiki data I ended up I did it I ran a process which I think was this I think was in this repository around June around June to July of essentially doing mass upload mass updates of all of these shrines or initially imported from the tables on Japanese I originally imported from the originally imported from the tables on Japanese Wikipedia and I did a cursed thing through Excel in order to get them so it's it became very messy but I ended up getting the shrines and I ended up getting all the shrines I actually the first thing I did like the first thing I did when I was on with your dad I was like I ran a bunch of different scripts to try to get import from Japanese categorization into wiki data for instance of the different shrine ranks then I did the thing through the lists and then after the list were finished after the lists were finished then I proceeded from there after the lists were were finished then I proceeded from there to after all the lists were finished I proceeded from there to after all the lists were finished I've been proceeded I've didn't realize that there was like some information about like the Compa Coco of our imperial on the train non-imperial train that was causing some issues with those was causing me some issues because I saw something to describe at this I found another database which is the Coco university database there was a weird weird situation with the with the shrines were basically there was an old shrine database according to the person who created the shrine database they are created the tables they took them all from the Coco university website but the main main issue is number one they have a very large amount of is there some some errors there was like some dumb shit where they were made into templates that made like everything much harder I tried manually translating the list but then that failed ChatGPT could not handle those but so instead of what I did was I translated the list from but but like yeah the script stuff worked well the scripts worked decently well and but I ended up basically from that database I ended up getting a very large amount of duplications of the king Ivan show and you can look at the wiki project Shinto you can look at the wiki product project Chinto history to see what was going on and how there's massive massive amount of backlash or what I did over the wicked pipeline but suffice to say I have but suffice to say I've managed to very funny they they got extremely angry and always proposed to ban me but they never actually like removed my information later on I started generating the Shiki Aisha list on this wiki using scripts based off of wiki data and there is a bit of messiness of them messiness the quality of them I think because I was still using ChatGPT or something and because the earlier scripts actively generated shrine pages that was an intentional move on my part that was an intentional move on my part and because of my my efforts to clean up I believe at this point there is a single shrine for every single Racha or or like confirmed thing there's pages for all of them on this wiki and they all correspond to data most many pages are linked directly on wiki data with the Mize article property but this is not always the case particularly for the more recent ones for these ones I systematically imported the Japanese wiki content and at first I tried to use ChatGPT translation on them and that worked for a lot of them then I switched to using Kodak to translate them I use Claude for a few I established like a Japanese Link template thing that was specific specifically like I ran a script to get the wiki data but yeah so right now all of them only have links that work with wiki data or they're just kind of broken links but they're just kind of broken into her language links they linked to in Unknown is their target this is a bit of this was a bit of a flaw in my workflow but most of them are relatively obvious what they actually correspond to

Categories were all templates have some issues with like templates often times have their categories accidentally not put in the no include section and because of a script a category consolidation script that I was that I ran which I was supposed to only run on category space and main space but it ran on the template space two and that was a bit of a problem I feel like we can pretty easily deal with it the main issue was just some categories some templates add categories so this is a bit of a bit of a concern but not a huge amount as for the category space I think I was talking to you earlier about it and if you look at the recent commits in this in this in here a lot of them are about doing all of them were like updating scripts related to doing category shit so the category shit that we were doing is so I specifically specifically I specifically specifically removed the categories from being a place that would be translated in by the agents because of the fact that translating categories almost always makes them useless because a lot of instead I'm because like an earlier situation of translating categories usually it just ends up with slight paraphrases make it so suddenly things are not in the same category so the solution is that basically categories is really really need to be done by wiki data some categories don't have wiki data which is annoying and these category but yeah and some of our older scripts we were often running some of our older scripts in part without realizing the level of techno that some of them did weird things like they added all of the inter wick keys but they didn't add the wicked data which is kind of useless so we needed to run another script that added the wiki Data added the wiki link currently are wiki data link linked link thing has run on all the categories all of our categories and all of our pages have wiki data QID if you just entered into the page it redirect there but the categories there's a bit of them that are absent and that is a bit of a concern I think the actual best solution for it is simply we wanna look through our edit history to see which categories had the wiki data links added to them last and then we'll do stuff with it and then we'll do stuff with them because there's that one category because we have like a clear category thing and we're just going to like simply do text replace across the across all the different pages in the category to move them in the new into the English English language translation translated one this is pretty simple we could do a history merge on the categories if you want who the fuck cares I did like I would probably like a pen a pen the text or something I'd probably append the text or something it's a very large amount of legitimate Japanese language categories that do not have wiki status and this is kind of a problem a lot of them have relatively systematic names but yeah yeah we still need to kind of like we had category generator and we had like a category wicked have a thing but like we kinda didn't really have them working in sync and that was kind of a problem because our ideas we wanna have a we wanna have like a canonical English language name that every single category kind of goes into we also want to later on kind of putting in active work to strip a lot of of the pages of like that kind of bullshit categories either maintenance categories that were poorly documented enough that they essentially don't help in any meaningful way a couple a couple categories were actively made with Like a couple categories were kind of actively made through like tax replacements gone wrong or like or like glitches and most of our like argument our main space and template are generally good or category Space really does not have much like the actual category pages they often times have the Japanese language they sometimes have the Japanese language really really weirdly because like a lot of it was treated more like a weird technical playground thing a lot of the Japanese language category all the categories have the full Japanese language text they have a fuck ton of like categories they're in some of which are bullshit categories and then they have a and then they have like a they have like other stuff so our policy which I think I explained earlier but I don't really know is basically we want to preserve is basically we want to kind of after we finish up with all of the like merging the categories standardizing them to English names for our existing categories we want to basically more or less clearly content of all of the categories the only we are not going to be we're not gonna really be treating them as being like substantial things one but there are a couple issues one is sometimes but like we have but the important thing is like we have category navigation templates a lot of them work with this kind of dumb well it's not dumb it's actually very smart there's a very clever Japanese template Japanese Wikipedia template navigator thing but like kinda does like a rex on the prefectures or rex on the provinces or something I don't know what it is it isn't something that we want though it's something that is kind of bullshit it's something that is it's something that's kind of bullshit but we want like navigation template for the individual thing I figure like English language Wikipedia might need this at some point it probably need this for state or whatever but but yeah like we have that our categories are pretty much a mess in this way and my intention with the categories is basic the categories are just our intention with the categories is basically the categories is more or less should be human navigable and we should be doing a lot of our data on other things and I am thinking probably we can actually like programmatically generate the some decent text on the categories category categories by the way like categories and templates both have like the both are going to also have the Lake the the Wikipedia export part the promenade the promenade integrated data thing the bridge Meta data thing and then the human readable part with the with us doing a similar kind of processing although I do imagine that it's gonna be not as hot as heavy-handed or intention as I said before with our talk pages is basically basically with a few is basically that our intention with talk pages are like I think I've basically established is that like I think I used I think I basically established it is that our talk pages are just kind of bullshit like I don't think anybody's actually done any talking on our talk pages so I don't think anybody's actually done any talking on our talk pages so I don't think anybody's actually done any talking on our talk pages so our talk pages can be relatively easily kind of relatively easily discarded I'm not 100% sure I think what I think I am going to do with our talk pages is basically have it so but yeah I said like basically my policy is going to be that we just we essentially import the entire talk pages page of the of the article in every single language on Wikipedia I think probably will just like make it so that whatever credit is on our talk page is going to be considered its own it's gonna be its own section at the bottom of the talk page and we just have a comment basically saying that and then we have a comment saying this is where it's imported etc. that has a specific date that kind of reset the timer we have our navigation thing on the on the talk page and all this other stuff I think that makes sense I feel like I basically explain all of the history I feel like I've basically explained all the history I am going to commit this now then I am going to save the wiki project Shinto I'm going to save the wiki project Shinto crap into into another file here so the Claude can also use it so that Claude can also use it it's a bit of a mess but it's it's a bit of a mess but I figure it gives enough context to kind of figure out why it is that why does it certain things are being done and yeah like all right 00 also our automatic page creation that we did with our automatic page creation that we did with the with our automatic page creation that we did with that or the English shrines the English shrines I realize that the speech to text just totally did not catch that at all and probably any kind of random word that it's just completely lost is like is SHIKINAISHA and it refers to shrines in the ENGISHIKI and these were like the automatically automatically created things that I mentioned earlier and yeah a lot lot most of them don't have wiki data and entries and like there's like a difference between the candidates and the identified ones and like the but the ones that are disputed and we have that in our categorization but basically the issue that we have is the ones with Japanese language content tend to be kind but the ones with Japanese language content on them tend to be a bit weird but the integration of the our automatic generator really kind of was excessive with the content that it added it was like excessive because it was more or less just almost a print of the wick data stuff and also and like we ran we ran a pass on our inter language link thing the prop made it to most of them are properly linked to wherever they were supposed to be going to a lot of other things didn't properly go there earlier but yeah just like to keep all this to keep all this in mind like it's some keep all this stuff in mind it is keep all this stuff in mind when doing this I feel like I think I actually gave a relatively established thing vision vision   keep all this stuff in mind when doing this I feel like I think I actually gave a relatively established thing vision vision.TXT is the thing that kind of explains my idea of how the name would work and we are basically gonna be running like a we're gonna be running like a relatively constant bot on the wiki that tracks the chain like tracks changes and stuff like that it might do it might even we might even be able to do like I have actions to edit the page but that's like I don't know about that that seems like a bit that seems a bit questionable yeah OK whatever I am finally committing this I am finally finished this I am going to now figure out what the fuck is going on with my with a repository on my computer and get Claude to kinda organize this stuff a bit more and I'm going to commit the and I'm going to commit the the wiki data discussion I'm going to commit the wicked data discussion as of today I'm going to commit the wicked other discussion as of today and then I'm going to run to do a bit more planning more planning and organizing of these notes and stuff a bit better because like the goal again is basically the goal again it is basically we are completely matching all the stuff we're probably I would say it like a potential goal that we would have for this wiki would be that we can almost like almost like completely run completely automated completely automated translation pipelines that it'll take like any given page in Japanese and run it and have it so that it is like consistent that would be like it probably a goal of ours but yeah we do need to do it and also there's like a bunch of there's a bunch of random crud on the wiki from like there's a bunch of random crowd on the wiki that we need to clear and like a large part of why it is I haven't been clearing it yet cause I love it the stuff is actually in the archives of the wiki and the stuff that's in the archives of the wiki basically is like it kind of neat it'll just if I actually deleted it just gets restored 
  
